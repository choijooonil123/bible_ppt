<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì„±ê²½ PPT ìƒì„±ê¸° (Web)</title>

  <!-- ìŠ¤íƒ€ì¼ -->
  <link rel="stylesheet" href="styles.css" />

  <!-- PptxGenJS ë¡œë” -->
  <script>
    (async function loadPptxGen() {
      const sources = [
        "libs/pptxgen.bundle.js",
        "https://cdn.jsdelivr.net/npm/pptxgenjs@4.0.1/dist/pptxgen.bundle.js",
        "https://unpkg.com/pptxgenjs@4.0.1/dist/pptxgen.bundle.js"
      ];
      for (const src of sources) {
        try {
          await new Promise((ok, no) => {
            const s = document.createElement("script");
            s.src = src; s.defer = true;
            s.onload = ok; s.onerror = () => no(new Error("fail " + src));
            document.head.appendChild(s);
          });
          if (window.PptxGenJS) {
            console.log("PptxGenJS loaded from:", src);
            return;
          }
        } catch (e) { console.warn(e.message); }
      }
      alert("PptxGenJS ë¡œë“œ ì‹¤íŒ¨: ë¡œì»¬ libs/pptxgen.bundle.js ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•˜ì„¸ìš”.");
    })();
  </script>

  <!-- ì•± ìŠ¤í¬ë¦½íŠ¸ -->
  <script defer src="app.js"></script>
</head>
<body>
  <div class="container">
    <h1>ğŸ“– ì„±ê²½ PPT ìƒì„±ê¸°</h1>

    <label for="reference">ì„±ê²½ ë²”ìœ„ ì…ë ¥</label>
    <input
      id="reference"
      type="text"
      placeholder="ì˜ˆ) ìš” 3:16, ìš” 3:16~18, ìš” 3:16~4:3 (ì—¬ëŸ¬ êµ¬ê°„ì€ ì½¤ë§ˆ ë˜ëŠ” ì¤„ë°”ê¿ˆ)"
    />

    <button onclick="generatePPT()">PPT ìƒì„±</button>

    <!-- ì§„í–‰ìƒíƒœ ì¶œë ¥ ì˜ì—­ -->
    <div id="status" style="margin-top:16px; padding:10px; border:1px solid #aaa; border-radius:5px; min-height:60px; font-size:14px; background:#f9f9f9; overflow-y:auto;"></div>
  </div>

  <script>
    // ìƒíƒœ ë©”ì‹œì§€ ì¶”ê°€ í•¨ìˆ˜
    function logStatus(msg) {
      const status = document.getElementById("status");
      const p = document.createElement("div");
      p.textContent = "â–¶ " + msg;
      status.appendChild(p);
      status.scrollTop = status.scrollHeight;
    }

    // Enter í‚¤ ì…ë ¥ ì‹œ PPT ìƒì„± ì‹¤í–‰
    document.getElementById("reference").addEventListener("keydown", function(e) {
      if (e.key === "Enter") {
        e.preventDefault(); // ê¸°ë³¸ submit ë°©ì§€
        generatePPT();
      }
    });

    // ì „ì—­ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ export
    window.logStatus = logStatus;
  </script>
</body>
</html>
