<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>성경 PPT 생성기 (Web)</title>

  <!-- 스타일 -->
  <link rel="stylesheet" href="styles.css" />

  <!-- PptxGenJS 로더 -->
  <script>
    (async function loadPptxGen() {
      const sources = [
        "libs/pptxgen.bundle.js",
        "https://cdn.jsdelivr.net/npm/pptxgenjs@4.0.1/dist/pptxgen.bundle.js",
        "https://unpkg.com/pptxgenjs@4.0.1/dist/pptxgen.bundle.js"
      ];
      for (const src of sources) {
        try {
          await new Promise((ok, no) => {
            const s = document.createElement("script");
            s.src = src; s.defer = true;
            s.onload = ok; s.onerror = () => no(new Error("fail " + src));
            document.head.appendChild(s);
          });
          if (window.PptxGenJS) {
            console.log("PptxGenJS loaded from:", src);
            return;
          }
        } catch (e) { console.warn(e.message); }
      }
      alert("PptxGenJS 로드 실패: 로컬 libs/pptxgen.bundle.js 또는 네트워크를 확인하세요.");
    })();
  </script>

  <!-- 앱 스크립트 -->
  <script defer src="app.js"></script>
</head>
<body>
  <div class="container">
    <h1>📖 성경 PPT 생성기</h1>

    <label for="reference">성경 범위 입력</label>
    <input
      id="reference"
      type="text"
      placeholder="예) 요 3:16, 요 3:16~18, 요 3:16~4:3 (여러 구간은 콤마 또는 줄바꿈)"
    />

    <button onclick="generatePPT()">PPT 생성</button>

    <!-- 진행상태 출력 영역 -->
    <div id="status" style="margin-top:16px; padding:10px; border:1px solid #aaa; border-radius:5px; min-height:60px; font-size:14px; background:#f9f9f9; overflow-y:auto;"></div>
  </div>

  <script>
    // 상태 메시지 추가 함수
    function logStatus(msg) {
      const status = document.getElementById("status");
      const p = document.createElement("div");
      p.textContent = "▶ " + msg;
      status.appendChild(p);
      status.scrollTop = status.scrollHeight;
    }

    // Enter 키 입력 시 PPT 생성 실행
    document.getElementById("reference").addEventListener("keydown", function(e) {
      if (e.key === "Enter") {
        e.preventDefault(); // 기본 submit 방지
        generatePPT();
      }
    });

    // 전역에서 사용 가능하도록 export
    window.logStatus = logStatus;
  </script>
</body>
</html>
